# Database Migrations Guide | ุฏููู ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงููุฌูุฏ ูุญุชูู ุนูู ูููุงุช ุงูู Migrations ุงูุชู ุชูุดุฆ ูุชุญุฏูุซ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

## ุงููููุงุช

| ุงูููู | ุงููุตู |
|-------|-------|
| `001_initial_schema.sql` | ุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ |
| `002_seed_data.sql` | ุงูุจูุงูุงุช ุงูุฃูููุฉ (ุงูุฃุฏูุงุฑุ ุงูุญุงูุงุชุ ุงููุฏู) |
| `003_create_admin_user.sql` | ุฅูุดุงุก ุงููุณุชุฎุฏู ุงูุฅุฏุงุฑู ุงูุงูุชุฑุงุถู |
| `004_create_settings_table.sql` | ุฌุฏูู ุงูุฅุนุฏุงุฏุงุช (JSONB) |
| `run.js` | ุณูุฑุจุช ุชุดุบูู ุงูู Migrations |
| `seed.js` | ุจูุงูุงุช ุชุฌุฑูุจูุฉ ููุชุทููุฑ |

## ุงูุฃูุงูุฑ ุงููุชุงุญุฉ

```bash
# ุชุดุบูู ุฌููุน ุงูู Migrations ุงููุนููุฉ
npm run migrate

# ุนุฑุถ ุญุงูุฉ ุงูู Migrations
npm run migrate:status

# ุฅุนุงุฏุฉ ุชุนููู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุญุฐู ูุฅุนุงุฏุฉ ุฅูุดุงุก - ุฎุทูุฑ!)
npm run migrate:reset

# ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ
npm run seed
```

## ููููุฉ ุนูู ุงููุธุงู

1. ุนูุฏ ุชุดุบูู `npm run migrate`ุ ูุชู ุฅูุดุงุก ุฌุฏูู `schema_migrations` ูุชุชุจุน ุงูู Migrations ุงูููุทุจููุฉ.
2. ูุชู ูุญุต ูู ููู SQL ุจุงูุชุฑุชูุจ.
3. ุฅุฐุง ูู ููู ุงูููู ููุทุจููุงู ูุณุจูุงูุ ูุชู ุชูููุฐู ูุชุณุฌููู.
4. ุงููููุงุช ุงูููุทุจููุฉ ูุณุจูุงู ูุชู ุชุฎุทููุง ุชููุงุฆูุงู.

## ุฅุถุงูุฉ Migration ุฌุฏูุฏ

1. ุฃูุดุฆ ููู SQL ุฌุฏูุฏ ุจุงูุชูุณูู: `006_description.sql`
2. ุฃุถู ุงุณู ุงูููู ุฅูู ูุตูููุฉ `MIGRATIONS` ูู `run.js`
3. ุดุบูู `npm run migrate`

## ูุซุงู ุนูู Migration ุฌุฏูุฏ

```sql
-- Migration: 006 Add new feature
-- Date: 2025-12-15
-- Description: Adding a new table for X feature

CREATE TABLE IF NOT EXISTS new_table (
    id VARCHAR(100) PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX IF NOT EXISTS idx_new_table_name ON new_table(name);
```

## ููุงุญุธุงุช ูููุฉ

> โ๏ธ **ุชุญุฐูุฑ**: ูุง ุชุณุชุฎุฏู `migrate:reset` ุนูู ุงูุฅูุชุงุฌ! ุณูุญุฐู ุฌููุน ุงูุจูุงูุงุช.

> ๐ก **ูุตูุญุฉ**: ูุจู ุงูููู ูู VPS ุฌุฏูุฏุ ุดุบูู `npm run migrate:status` ููุชุฃูุฏ ูู ุฌุงูุฒูุฉ ุฌููุน ุงููููุงุช.

> ๐ **ุฃูุงู**: ุบููุฑ ูููุฉ ูุฑูุฑ ุงููุฏูุฑ ูู `003_create_admin_user.sql` ูุจู ุงูุฅูุชุงุฌ.

## ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ

```
roles               - ุฃุฏูุงุฑ ุงููุณุชุฎุฏููู
users               - ุงููุณุชุฎุฏููู
statuses            - ุญุงูุงุช ุงูุทูุจุงุช
cities              - ุงููุฏู
regions             - ุงูููุงุทู
orders              - ุงูุทูุจุงุช
drivers             - ุจูุงูุงุช ุงูุณุงุฆููู (GPS)
order_tracking      - ุณุฌู ุชุชุจุน ุงูุทูุจุงุช
driver_payment_slips    - ูุดููุงุช ุฏูุน ุงูุณุงุฆููู
merchant_payment_slips  - ูุดููุงุช ุฏูุน ุงูุชุฌุงุฑ
driver_return_slips     - ูุฑุชุฌุนุงุช ุงูุณุงุฆููู
merchant_return_slips   - ูุฑุชุฌุนุงุช ุงูุชุฌุงุฑ
settings            - ุฅุนุฏุงุฏุงุช ุงููุธุงู
schema_migrations   - ุชุชุจุน ุงูู Migrations
```
